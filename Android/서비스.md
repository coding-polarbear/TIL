# 서비스
> 서비스는 UI를 제공하지 않고 백그라운드에서 실행되는 컴포넌트

### 백그라운드 스레드에서 작업을 오래 하는 문제
* 앱이 시작되면 선행 작업이 필요한 경우가 있음.
* 실행시간이 오래 걸리게되면 UI를 블로킹하지 않기 위해 백그라운드 스레드로 작업을 진행함.
* 스레드 실행을 마치기 전에 백키로 앱을 빠져나오거나 홈 키로 나가서 다른 앱을 오랫동안 사용하면, 프로세스가 종료될 수 있음.
* Application뿐만 아니라 액티비티에서도 마찬가지로 시간이 오래 걸리는 작업을 스레드에서 실행하고 있다면 안정성에 문제가 생김.


### 프로세스 우선순위
1. 포그라운드 프로세스
* 안드로이드 컴포넌트가 포그라운드에서 실행되는 프로세스
* 사용자와 상호 작용하는 액티비티에 바운된 서비스를 가지고 있거나, `startForeground()`를 호출한 포그라운드 서비스를 가지고 있거나, 서비스 생명주기를 실행중인 서비스를 가지고 있거나, 브로드캐스트 리시버를 가지고 있는 경우
* 메모리가 부족할 때에도 가장 마지막까지 남을 수 있는 프로세스
2. 가시(visible) 프로세스
* 포그라운드 컴포넌트를 가지고 있지는 않지만 사용자가 보는 화면에 아직 영향이 있는 프로세스
* 액티비티로 본다면 `onPause()`까지 실행되었지만 가시 상태인 것.
* 가시 액티비티에 바운드된 서비스를 실행 중인 프로세스도 가시 프로세스에 해당함.
3. 서비스 프로세스
* `startService()`로 실행하지만 위의 카테고리에는 들어가지 않는 서비스
* 사용자가 지금 보고 있는 것과 직접적인 연관은 없음.
4. 백그라운드 프로세스
* 액티비티가 종료된 것은 아니지만 사용자엑 더이상 보이지 않고 활성화된 컴포넌트가 없는 프로세스
* 보통 백그라운드 프로세스가 여러 개 존재함.
5. 빈(empty) 프로세스
* 사용자가 백 키로 액티비티를 모두 종료하고 활성화된 컴포넌트가 없는 상태
* 이러한 프로세스를 메모리에 한동한 유지하는 이유는 다음에 컴포넌트를 다시 띄울때 빠르게 띄을 수 있도록 캐시로 사용하기 위해서
* 우선순위가 낮아서 리소스가 부족하면 가장 먼저 종료 대상이 됨.
  
### 서비스는 UI 스레드에서 실행
* 서비스는 액티비티처럼 눈에 보이는 가시 컴포넌트가 아니라는 의미로 백그라운드를 이야기하는 것이지, 서비스 자체가 메인 스레드가 아닌 별도 스레드에서 실행하는 것으로 착각하면 안됨.
* 서비스의 생명주기 메소드는 UI 스레드에서 실행되고 이 때문에 다른 UI 를 블로킹하는 작업이 있다면 스레드를 생성해서 작업을 진행해야 함.

### 서비스는 단일 인스턴스로 실행
* 서비스는 앱에서 1개의 인스턴스밖에 생기지 않음
* 일부러 싱글톤 객체를 만들고 그 안에서 백그라운드 실행할 필요가 없음.

### 서비스 시작 방법
* Context에는 서비스를 시작하는 압법으로 `startService()`와 `bindService()` 메소드 2 가지가 있음.
  
### 스타티드 & 바운드 서비스
* 스타티드면서 바운드 일 수도 있음.